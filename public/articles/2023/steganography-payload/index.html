<!doctype html><html lang=en><head><meta charset=utf-8><title>Matt Hammond Inc | Steganography Payload</title>
<meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href=https://matthammond.com/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://matthammond.com/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://matthammond.com/favicon/favicon-16x16.png><link rel=manifest href=https://matthammond.com/favicon/site.webmanifest><link rel=mask-icon href=https://matthammond.com/favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=https://matthammond.com/favicon/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config content="https://matthammond.com/favicon/browserconfig.xml"><meta name=theme-color content="#ffffff"><link href=/css/fa6.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/style.css><link href=/css/style.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/custom.css><meta property="og:title" content="Matt Hammond Inc | Steganography Payload"></head><body class="flex flex-col min-h-screen bg-nord-6"><main class=flex-grow><header><div id=overlay><ul class="text-center list-none text-white text-3xl"><li class=p-2><a href=/services/><span>Services</span></a></li><li class=p-2><a href=/articles/><span>Articles</span></a></li><li class=p-2><a href=/about/><span>About</span></a></li><li class=p-2><a href=/contact/><span>Contact</span></a></li></ul></div><nav class="flex items-center justify-between flex-wrap bg-nord-0 p-8"><div class="flex items-center flex-shrink-0 text-xl text-nord-0 mr-6"><a href=https://matthammond.com/><img alt="Matt Hammond Inc" class="h-16 mr-3" src=/img/logos/logo.png></a></div><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:52,backgroundColor:"#3B4252",textColor:"#ECEFF4"})</script><div class="hidden w-full block flex-grow lg:flex lg:items-center lg:w-auto" id=mobileMenu><div class="text-lg lg:flex-grow"></div><div class=text-lg><a href=/services/ class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-nord-6 hover:opacity-60 mr-8">Services
</a><a href=/articles/ class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-nord-6 hover:opacity-60 mr-8">Articles
</a><a href=/about/ class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-nord-6 hover:opacity-60 mr-8">About
</a><a href=/contact/ class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-nord-6 hover:opacity-60 mr-8">Contact</a></div></div></nav></header><div class="mx-auto my-10 max-w-6xl"><div class="mx-3 col-span-3 lg:col-span-2 px-2"><h1 class="title text-5xl font-bold mb-3">Steganography Payload</h1><section class="mb-4 text-lg"><h4 id=date class="flex flex-row items-center"><span class="icon-access_time text-2xl mr-2"></span> January 11, 2023</h4><h4 class="flex flex-row items-center"><span class="icon-person text-2xl mr-2"></span>Matt Hammond</h4></section><div class="content prose md:prose-lg lg:prose-xl max-w-none py-1 text-nord-0"><h2 id=create-payload>Create Payload</h2><ul><li>create a bash script (i.e. payload.sh)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nb>echo</span> <span class=s2>&#34;This is the payload script&#34;</span>
</span></span></code></pre></div><ul><li>transform script to base64</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat payload.sh <span class=p>|</span> base64 <span class=p>|</span> tr -d <span class=s1>&#39;\n&#39;</span>
</span></span></code></pre></div><h2 id=embed-payload>Embed Payload</h2><ul><li>clear metadata from image</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>exiftool -all<span class=o>=</span> image.jpg
</span></span></code></pre></div><ul><li>load hash into image</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>exiftool -Certificate<span class=o>=</span><span class=s1>&#39;base64 hash&#39;</span> image.jpg
</span></span></code></pre></div><h2 id=execute-payload>Execute Payload</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>p</span><span class=o>=</span><span class=k>$(</span>cat image.jpg <span class=p>|</span> grep Cert -a <span class=p>|</span> sed <span class=s1>&#39;s/&lt;[^&gt;]*&gt;//g&#39;</span> <span class=p>|</span> base64 -D<span class=k>)</span><span class=p>;</span><span class=nb>eval</span> <span class=nv>$p</span>
</span></span></code></pre></div><script src=https://giscus.app/client.js data-repo=matthewshammond/website data-repo-id=R_kgDOIvbsJA data-category=Comments data-category-id=DIC_kwDOIvbsJM4Ce6wo data-mapping=title data-reactions-enabled=0 data-theme=dark_dimmed crossorigin=anonymous async></script></div></div></div><script src=/js/code-copy.js></script></main><footer class=bg-tlgray-100><script src=/js/clipboard.min.js></script><script src=/js/highlight.min.js></script><script src=/js/highlightjs-line-numbers.min.js></script><script src=/js/sweetalert2.min.js></script><script>hljs.initHighlightingOnLoad(),hljs.initLineNumbersOnLoad(),new ClipboardJS(".url");function OnClickURL(){Swal.fire({icon:"success",title:"Copied!",text:"Copied the URL and title."})}</script><script>function toggleNav(){var e=document.getElementById("hamburgerbtn"),t=document.getElementById("overlay"),n=document.body;e.addEventListener("click",function(){t.classList.toggle("open"),e.classList.toggle("is-open"),n.classList.toggle("scroll-lock")})}toggleNav(),document.querySelector(".scroll-top").addEventListener("click",()=>{document.documentElement.scrollTop=0})</script><link href="https://fonts.googleapis.com/css2?family=PT+Sans&display=swap" rel=stylesheet><div class="flex items-center justify-between flex-wrap bg-nord-0 p-8 text-nord-6"><div class="flex items-center flex-shrink-0 text-xl text-nord-0 mr-6"><a href=https://matthammond.com/><img alt="Matt Hammond Inc" class="h-16 mr-3" src=/img/logos/logo.png></a></div><div class="w-full block flex-grow lg:flex lg:items-center lg:w-auto"><div class="text-lg lg:flex-grow"></div><div class="flex flex-row items-center text-lg"><a href="https://keys.openpgp.org/search?q=matt%40matthammond.com">PGP public key fingerprint: CC62 A990 773D 843D 7E27 3E0D 6350 0E3E B057 5884</a></div></div><div class="w-full block flex-grow lg:flex lg:items-center lg:w-auto" id=mobileMenu><div class="text-lg lg:flex-grow"></div><div class="flex flex-row items-center text-lg"><a href=https://github.com/matthewshammond class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8"><i class='fab fa-github text-2xl'></i>
</a><a href=https://linkedin.com/in/matthewshammond class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8"><i class='fab fa-linkedin text-2xl'></i>
</a><a href=https://discord.gg/kU2wgApBgK class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8"><i class='fab fa-discord text-2xl'></i></a></div></div></div><div class="copy pl-8 py-5 bg-tlgray-700 text-nord-6 text-md">&copy; Matt Hammond Inc 2024 All Rights Reserved.</div></footer></body></html>