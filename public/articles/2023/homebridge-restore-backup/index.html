<!doctype html><html lang=en><head><meta charset=utf-8><title>Matt Hammond Inc | Homebridge Restore Backup</title>
<meta name=viewport content="width=device-width,initial-scale=1"><link rel=apple-touch-icon sizes=180x180 href=https://matthammond.com/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://matthammond.com/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://matthammond.com/favicon/favicon-16x16.png><link rel=manifest href=https://matthammond.com/favicon/site.webmanifest><link rel=mask-icon href=https://matthammond.com/favicon/safari-pinned-tab.svg color=#5bbad5><link rel="shortcut icon" href=https://matthammond.com/favicon/favicon.ico><meta name=msapplication-TileColor content="#da532c"><meta name=msapplication-config content="https://matthammond.com/favicon/browserconfig.xml"><meta name=theme-color content="#ffffff"><link href=/css/fa6.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/style.css><link href=/css/style.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/css/custom.css><meta property="og:title" content="Matt Hammond Inc | Homebridge Restore Backup"></head><body class="flex flex-col min-h-screen bg-nord-6"><main class=flex-grow><header><div id=overlay><ul class="text-center list-none text-white text-3xl"><li class=p-2><a href=/services/><span>Services</span></a></li><li class=p-2><a href=/articles/><span>Articles</span></a></li><li class=p-2><a href=/about/><span>About</span></a></li><li class=p-2><a href=/contact/><span>Contact</span></a></li></ul></div><nav class="flex items-center justify-between flex-wrap bg-nord-0 p-8"><div class="flex items-center flex-shrink-0 text-xl text-nord-0 mr-6"><a href=https://matthammond.com/><img alt="Matt Hammond Inc" class="h-16 mr-3" src=/img/logos/logo.png></a></div><div class="block lg:hidden"><div id=hamburgerbtn class="flex cursor-pointer items-center w-14 h-10 py-2 rounded mopen"><span class=top></span>
<span class=middle></span>
<span class=bottom></span></div></div><script src=https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js></script><script>addBackToTop({diameter:52,backgroundColor:"#3B4252",textColor:"#ECEFF4"})</script><div class="hidden w-full block flex-grow lg:flex lg:items-center lg:w-auto" id=mobileMenu><div class="text-lg lg:flex-grow"></div><div class=text-lg><a href=/services/ class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-nord-6 hover:opacity-60 mr-8">Services
</a><a href=/articles/ class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-nord-6 hover:opacity-60 mr-8">Articles
</a><a href=/about/ class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-nord-6 hover:opacity-60 mr-8">About
</a><a href=/contact/ class="duration-200 block mt-4 lg:inline-block lg:mt-0 text-nord-6 hover:opacity-60 mr-8">Contact</a></div></div></nav></header><div class="mx-auto my-10 max-w-6xl"><div class="mx-3 col-span-3 lg:col-span-2 px-2"><h1 class="title text-5xl font-bold mb-3">Homebridge Restore Backup</h1><section class="mb-4 text-lg"><h4 id=date class="flex flex-row items-center"><span class="icon-access_time text-2xl mr-2"></span> November 24, 2023</h4><h4 class="flex flex-row items-center"><span class="icon-person text-2xl mr-2"></span>Matt Hammond</h4></section><div class="content prose md:prose-lg lg:prose-xl max-w-none py-1 text-nord-0"><h2 id=issue>Issue</h2><p>When updating homebridge in docker with the onzu build, sometimes you may not be able to restore from your backup. I was able to restore via the command line; however, I had to manually reinstall my plugins. The good news is once you install the plugins via the Web UI, you do not have to reconfigure.</p><h2 id=fix>Fix</h2><p>Extract your <strong>homebridge-backup.tar.gz</strong> into a folder. Navigate to <code>/var/lib/docker/volumes/homebridge_homebridge/_data</code> (you may have to switch to root - <code>sudo su</code>).</p><p>In <code>/var/lib/docker/volumes/homebridge_homebridge/\_data</code> delete:</p><ul><li>accessories</li><li>auth.json</li><li>backups</li><li>config.json</li><li>persist</li><li>plugin-persist</li><li>.uix-dashboard.json</li><li>.uix-secrets</li></ul><p>Then copy everything from the storage folder within the extracted <strong>homebridge-backup.tar.gz</strong> (ensure you also copy <strong>.uix-dashboard.json</strong> & <strong>.uix-secrets</strong>) to the <code>/var/lib/docker/volumes/homebridge_homebridge/\_data</code>.</p><p>You then need to change the ownership of these files <code>chown root:root accessories auth.json backups config.json persist plugin-persist .uix-dashboard.json .uix-secrets</code></p><h2 id=conclusion>Conclusion</h2><p>Once this is all complete, restart your container and navigate to <code>localhost:8581</code>. In the Web UI go to plugins and find and install all the plugins you had. When the plugin installs, just close it, the configuration is already done from copying all your files earlier. For good measure, restart homebridge via the Web UI.</p><script src=https://giscus.app/client.js data-repo=matthewshammond/website data-repo-id=R_kgDOIvbsJA data-category=Comments data-category-id=DIC_kwDOIvbsJM4Ce6wo data-mapping=title data-reactions-enabled=0 data-theme=dark_dimmed crossorigin=anonymous async></script></div></div></div><script src=/js/code-copy.js></script></main><footer class=bg-tlgray-100><script src=/js/clipboard.min.js></script><script src=/js/highlight.min.js></script><script src=/js/highlightjs-line-numbers.min.js></script><script src=/js/sweetalert2.min.js></script><script>hljs.initHighlightingOnLoad(),hljs.initLineNumbersOnLoad(),new ClipboardJS(".url");function OnClickURL(){Swal.fire({icon:"success",title:"Copied!",text:"Copied the URL and title."})}</script><script>function toggleNav(){var e=document.getElementById("hamburgerbtn"),t=document.getElementById("overlay"),n=document.body;e.addEventListener("click",function(){t.classList.toggle("open"),e.classList.toggle("is-open"),n.classList.toggle("scroll-lock")})}toggleNav(),document.querySelector(".scroll-top").addEventListener("click",()=>{document.documentElement.scrollTop=0})</script><link href="https://fonts.googleapis.com/css2?family=PT+Sans&display=swap" rel=stylesheet><div class="flex items-center justify-between flex-wrap bg-nord-0 p-8 text-nord-6"><div class="flex items-center flex-shrink-0 text-xl text-nord-0 mr-6"><a href=https://matthammond.com/><img alt="Matt Hammond Inc" class="h-16 mr-3" src=/img/logos/logo.png></a></div><div class="hidden sm:hidden w-full block flex-grow lg:flex lg:items-center lg:w-auto"><div class="text-lg lg:flex-grow"></div><div class="flex flex-row items-center text-lg"><a href="https://keys.openpgp.org/search?q=matt%40matthammond.com">PGP public key fingerprint: CC62 A990 773D 843D 7E27 3E0D 6350 0E3E B057 5884</a></div></div><div class="w-full block flex-grow lg:flex lg:items-center lg:w-auto" id=mobileMenu><div class="text-lg lg:flex-grow"></div><div class="flex flex-row items-center text-lg"><a href=https://github.com/matthewshammond class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8"><i class='fab fa-github text-2xl'></i>
</a><a href=https://linkedin.com/in/matthewshammond class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8"><i class='fab fa-linkedin text-2xl'></i>
</a><a href=https://discord.gg/kU2wgApBgK class="block mt-4 lg:inline-block lg:mt-0 text-gray-300 hover:text-white mr-8"><i class='fab fa-discord text-2xl'></i></a></div></div></div><div class="copy pl-8 py-5 bg-tlgray-700 text-nord-6 text-md">&copy; Matt Hammond Inc 2024 All Rights Reserved.</div></footer></body></html>